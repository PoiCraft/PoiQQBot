<!DOCTYPE html>
<html>
  <head>
    <title>PoiQQBot</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
    * {
        margin: 0;
        padding: 0;
        border: 0;
        outline: 0;
      }
    #console {
        overflow:hidden;
        width:100%
        height:100vh;
    }
    </style>
  </head>
  <body>
    <div id="console">
    <div id="re">
    </div>
    <div id="inp">
    <small style="float: left; height: 34px; width: 80px; line-height: 34px;text-align: right">PoiQQBot></small>
    <input id="cmd" style="width:calc(100% - 80px);resize:none; height: 34px; float: left">
    </div>
    </div>
    <script>
    
    var element = document.getElementById('console')
    var cmd = document.getElementById("cmd")
    var re = document.getElementById("re")
    var inp = document.getElementById("inp")
    
    var ws = new WebSocket("ws://127.0.0.1:30000")
    ws.onmessage = function(e){
        _c = document.createElement("p")
        _c.innerHTML="<small>"+e.data+"</small>"
        re.appendChild(_c)
        inp.style.display="block"
        cmd.focus()
    }
    
    ws.onerror = function(){
        inp.style.display="none"
        _c = document.createElement("p")
        _c.innerHTML="<strong>连接断了</strong>"
        re.appendChild(_c)
    }
    cmd.focus()
    
    window.document.onkeydown = function(e){
        var keycode = event.keyCode
        
        if (keycode == 13) {
        _c = document.createElement("p")
        _c.innerHTML="<small>PoiQQBot>"+cmd.value+"</small>"
        re.appendChild(_c)
        ws.send(cmd.value)
        cmd.value=""
        inp.style.display="none"
        }
    }
    
    </script> 
  </body>
</html>